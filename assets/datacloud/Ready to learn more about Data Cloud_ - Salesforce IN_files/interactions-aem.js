var Lt=Object.create;var me=Object.defineProperty;var jt=Object.getOwnPropertyDescriptor;var Ft=Object.getOwnPropertyNames;var Gt=Object.getPrototypeOf,zt=Object.prototype.hasOwnProperty;var qt=(e,t,o)=>t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var Vt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var $t=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ft(t))!zt.call(e,n)&&n!==o&&me(e,n,{get:()=>t[n],enumerable:!(r=jt(t,n))||r.enumerable});return e};var Bt=(e,t,o)=>(o=e!=null?Lt(Gt(e)):{},$t(t||!e||!e.__esModule?me(o,"default",{value:e,enumerable:!0}):o,e));var k=(e,t,o)=>qt(e,typeof t!="symbol"?t+"":t,o);var ot=Vt((fe,ue)=>{"use strict";(function(e,t){typeof fe=="object"&&typeof ue<"u"?ue.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.fetchRetry=t())})(fe,(function(){"use strict";var e=function(r,n){if(n=n||{},typeof r!="function")throw new o("fetch must be a function");if(typeof n!="object")throw new o("defaults must be an object");if(n.retries!==void 0&&!t(n.retries))throw new o("retries must be a positive integer");if(n.retryDelay!==void 0&&!t(n.retryDelay)&&typeof n.retryDelay!="function")throw new o("retryDelay must be a positive integer or a function returning a positive integer");if(n.retryOn!==void 0&&!Array.isArray(n.retryOn)&&typeof n.retryOn!="function")throw new o("retryOn property expects an array or function");var s={retries:3,retryDelay:1e3,retryOn:[]};return n=Object.assign(s,n),function(c,m){var f=n.retries,v=n.retryDelay,w=n.retryOn;if(m&&m.retries!==void 0)if(t(m.retries))f=m.retries;else throw new o("retries must be a positive integer");if(m&&m.retryDelay!==void 0)if(t(m.retryDelay)||typeof m.retryDelay=="function")v=m.retryDelay;else throw new o("retryDelay must be a positive integer or a function returning a positive integer");if(m&&m.retryOn)if(Array.isArray(m.retryOn)||typeof m.retryOn=="function")w=m.retryOn;else throw new o("retryOn property expects an array or function");return new Promise(function(h,x){var ze=function(S){var ce=typeof Request<"u"&&c instanceof Request?c.clone():c;r(ce,m).then(function(u){if(Array.isArray(w)&&w.indexOf(u.status)===-1)h(u);else if(typeof w=="function")try{return Promise.resolve(w(S,null,u)).then(function(I){I?$(S,null,u):h(u)}).catch(x)}catch(I){x(I)}else S<f?$(S,null,u):h(u)}).catch(function(u){if(typeof w=="function")try{Promise.resolve(w(S,u,null)).then(function(I){I?$(S,u,null):x(u)}).catch(function(I){x(I)})}catch(I){x(I)}else S<f?$(S,u,null):x(u)})};function $(S,ce,u){var I=typeof v=="function"?v(S,ce,u):v;setTimeout(function(){ze(++S)},I)}ze(0)})}};function t(r){return Number.isInteger(r)&&r>=0}function o(r){this.name="ArgumentError",this.message=r}return e}))});globalThis.digitalData=globalThis.digitalData||{};globalThis.digitalData.timestamp=globalThis.digitalData.timestamp||new Date().getTime();var p=globalThis.digitalData;var Ht={LOCAL:"http://localhost:4000",DEV:"https://ogs-dev.digital.salesforce.com",QA:"https://ogs-qa.digital.salesforce.com",UAT:"https://ogs-stage.digital.salesforce.com",PROD:"https://ogs.digital.salesforce.com",PERF:"https://ogs-perf.digital.salesforce.com",HOTFIX:"https://ogs-hotfix.digital.salesforce.com"},Kt=()=>{let e=globalThis.ogsConfig,t=Ht[e.env?.toUpperCase()];if(t)return t;console.warn(`[OGS] Invalid or missing environment in config: ${e.env}`,e)},D=Kt(),le=e=>D&&e?`${D}${e}`:void 0,y=globalThis.ogsConfig;var Wt=e=>Object.entries(e).map(([t,o])=>o().then(r=>[t,r||""])),pe=async e=>{let t=Object.keys(e).reduce((o,r)=>(o[r]="",o),{});return Promise.allSettled(Wt(e)).then(o=>o.reduce((r,n)=>{if("value"in n){let[s,a]=n.value;a instanceof Object&&!Array.isArray(a)?(r={...r,...a},delete r[s]):r[s]=a}return r},t))};var qe=globalThis.cliLibsConfig||{},U={sfdcBase:globalThis.sfdcBase||{},clientLibs:qe,cdnOrigin:qe.cdnScriptsOrigin||""};var Jt="</|[<>()]",B=(e,t)=>e?e.trim().replace(new RegExp(Jt+t,"gi"),""):"",O={param:e=>B(e,"|(%3(c|e))"),path:e=>B(decodeURIComponent(e),`|'|"|;|=`),value:e=>B(e,"|[:;#$%]"),default:B};var d=e=>!e||e instanceof Object&&!Object.keys(e).length,Ve=e=>{let t={};if(typeof e!="string")return t;try{let o=JSON.parse(e);return o||t}catch{return t}},$e=e=>Object.fromEntries(Object.entries(e).map(([t,o])=>[o,t])),Be=!!(y.env&&y.env.toLowerCase()==="prod");var R=(e,t=250)=>new Promise(o=>{e()&&o(!0);let r=0,n=setInterval(()=>{r++,r>=t&&(clearInterval(n),o(!1)),e()&&(clearInterval(n),o(!0))},1)});var He=e=>{let t=(e||location.hostname).split(".");return t.slice(t.length-2).join(".")};var H=(e=location.search)=>e.replace("?","").split("&").reduce((t,o)=>{let r=o.split("=").filter(n=>!!n);return t[r[0]]=O.param(r[1]??""),t},{});var _="salesforce.com",K=O.default(y.clientId||"unknown");var Yt="ogs",W=e=>[Yt,e].join("_"),J=async(e,t)=>{if(!e||!t||d(t))return;let o=t instanceof Object?O.default(JSON.stringify(t)):O.value(t);localStorage.setItem(e,o)},Y=e=>{let t;if(e){t=localStorage.getItem(e);try{t=JSON.parse(t)}catch{}}return t??""};var b=(e="",t)=>{let o=document.cookie,r=`${e}=`;if(o.indexOf(r)<0)return"";let s=o.split("; ").find(c=>c.includes(r))||"";if(s=s.substring(r.length,s.length),!s||s===r)return"";typeof t=="function"&&(s=t(s)),s=decodeURIComponent(s);let a=Ve(s);return Object.keys(a).length?a:s},Xt="Thu, 01 Jan 1970 00:00:00 GMT",X=async(e,t)=>{let o=`${e}= ; expires=${Xt}`;document.cookie=o,document.cookie=`${o}; domain=${t||location.hostname}`},Ke=()=>Object.fromEntries(document.cookie.split("; ").map(e=>e.split("=")));var Zt="/idx/clerr",Qt={DEV:"www-dev",QA:"www-qa1",UAT:"www-uat1",PROD:"www",PERF:"www-perf",HOTFIX:"www-hfx"},We=()=>{let e=globalThis.ogsConfig,t=Qt[e.env?.toUpperCase()];if(t)return`https://${t}.${_}${Zt}`};var Je="ogsLogForwarding",eo={intervalMilli:3e4,batchSize:10,enableVisibilityChange:!0},Ye=e=>{if(to())return;let t=e||eo,o={config:{destinationUrl:We(),intervalMilli:t.intervalMilli,batchSize:t.batchSize,enableVisibilityChange:t.enableVisibilityChange},pool:{messages:[],lastSent:void 0},global:{}};so(o);let r=ro(o.config);no(o.config),o.intervalTimer=r},Xe=e=>{let t=A();t&&(t.pool.messages.push(e),oo(t))},to=()=>!!A(),oo=e=>{let o=e.config.batchSize;o<=0||e.pool.messages.length<o||Qe(e)},ro=e=>{let t=e.intervalMilli;if(t>0)return setInterval(Ze,t)},no=e=>{e.enableVisibilityChange&&window.addEventListener("visibilitychange",Ze)},Ze=()=>{let e=A();e&&Qe(e)},Qe=e=>{let o=e.pool.messages,r=e.config.destinationUrl;if(r&&o.length>0){let n=JSON.stringify(o);navigator.sendBeacon(r,n),e.pool.lastSent=new Date}e.pool.messages=[]},A=()=>globalThis[Je];var so=e=>{globalThis[Je]=e};var ao="ogs-debug-enabled",io="ogs-sdk",co=(e,t)=>{let o=P("info",e,t);N(console.info,!0,o,t)},mo=(e,t,o)=>{o={...o||{},error:t};let r=P("error",e,o);N(console.error,!0,r,o)},lo=(e,t)=>{let o=P("warn",e,t);N(console.warn,!0,o,t)},po=(e,t)=>{let o=P("debug",e,t);N(console.debug,!1,o,t)},fo=(e,t)=>{let o=P("trace",e,t);N(console.trace,!1,o,t)},P=(e,t,o)=>({msg:`[OGS] ${t}`,logLevel:e,time:Date.now(),data:go(o)}),uo=e=>["message","stack"].reduce((t,o)=>(e[o]&&(t[o]=e[o]),t),{}),go=e=>{let t=e||{},o={...t,env:y.env,location:window.location.href,ua:navigator.userAgent,appName:io,clientId:K,...A().global};return t.error&&(o.error=uo(t.error)),o},N=(e,t,o,r)=>{let{logToConsole:n=!0}=r||{};n&&ho(o.logLevel)&&e(o.msg,r),t&&Xe(o)},ho=e=>e==="error"||e==="warn"?!0:yo(),yo=()=>sessionStorage.getItem(ao)==="true",i={info:co,error:mo,warn:lo,trace:fo,debug:po};Ye();var et=".js",tt=e=>t=>{try{let o;"reason"in t&&(o=t,o.reason.stack.includes(e)&&i.warn("Error Caught",{error:o.reason,file:e}))}catch{}},de=async e=>{e&&(e.endsWith(et)||(e+=et),i.debug("Collecting Errors",{file:e}),window.addEventListener("unhandledrejection",tt(e)),window.addEventListener("error",tt(e),!0))};var st=Bt(ot(),1);var wo="ogs",bo=(...e)=>[wo,...e].join(":"),rt=(e,t,o)=>{let r=performance[e](bo(e,t),o),{detail:n}=r;return Object.entries(r.toJSON()).reduce((s,[a,c])=>(s[a]=c,s),{detail:n})},E=(e,t)=>rt("mark",e,{detail:t}),Z=(e,t={})=>(t={start:t.start||t.startTime,detail:t.detail||{}},rt("measure",e,t)),ge=e=>{let t=performance.getEntriesByType("resource").find(o=>o.name.includes(e));if(t)return t.toJSON()},nt=async(e,t)=>{let o=ge(t)||{};if(d(o)){i.debug(`Could not set ${e} metrics`);return}i.info(`${e} Metrics`,{...o}),Z(e,{start:o?.startTime}),E(`${e}:loaded`,{url:t})};var he="HTTP",at="Http call failed",So=async e=>{if(!e.ok){let t=await e.text();throw new Error(`HTTP error ${e.status}: ${t}`)}return e.json()},Io=()=>{typeof AbortSignal.timeout!="function"&&(AbortSignal.timeout=function(t){let o=new AbortController;return setTimeout(()=>o.abort(),t),o.signal})},Eo=async(e,t)=>{let{timeout:o}=t;return Io(),fetch(e,{...t,signal:AbortSignal.timeout(o),keepalive:!0})},vo=(e,t)=>(o,r,n)=>{let{maxAttempts:s,metrics:a,method:c,correlationId:m}=t,f=o<s&&(r!==null||n.status>=500);if(f){a.detail.attempts=o+1;let v={url:e,method:c},w=E(`${he}:${c}:retry`,{...a.detail||v,timestamp:new Date().toISOString()}),h=n?.status;r&&r.name==="AbortError"?h=408:h||(h=500),i.warn(`${at}. Attempting again`,{...v,correlationId:m,status:h,metrics:w,error:r,response:n?.json()??{}})}return f},it=e=>{let t=Math.pow(2,e)*100;return t+Math.floor(t*.2*Math.random())},Oo={method:"GET",timeout:3e4,maxAttempts:3,retryDelay:it,correlationId:"",keepalive:!0},xo=(e,t={})=>{let o={...Oo,...t},r={url:e,method:o.method,attempts:1,timestamp:new Date().toISOString()};return o.metrics||(o.metrics=E(`${he}:${o.method}`,r)),{retryOn:vo(e,o),responseParser:So,retryDelay:it,...o}},Q=async(e,t)=>{let o=xo(e,t),{retryDelay:r,retryOn:n,method:s,correlationId:a,metrics:c,responseParser:m}=o,f=(0,st.default)(Eo,{retryDelay:r,retryOn:n}),v=`${he}:${s}`,w={url:e,method:s,correlationId:a};return i.debug("Initiating Http call.",{url:e,method:s,correlationId:a,metrics:c}),f(e,o).then(h=>{let x=m(h);return i.info("Http call is successful",{...w,status:h.status,metrics:Z(`${v}:success`,c)}),x}).catch(h=>(i.warn(at,{...w,metrics:Z(`${v}:failed`,c),error:h}),Promise.reject(h)))};var Co=U.cdnOrigin||"https://c.salesforce.com";var To="/digital/@sfdc-ogs",ko="v1",Do="gdpr.js",Ro="v1",_o="/digital/one-trust/ext";var Ao="/digital/iis",ct="Could not resolve resource",mt={LOCAL:"latest",DEV:"latest",QA:"latest",UAT:"stage",PROD:"stable",PERF:"stage",HOTFIX:"stable"},Uo=()=>{let e=(y.env||"").toUpperCase();return e&&mt[e]?mt[e]:"stable"},Po={version:ko,baseDir:To,envTag:Uo()},ye=(e,t)=>{if(e)try{t={...Po,...t};let o=t.verDir||`${t.version}-${t.envTag}`,r=t.cdnHost||Co,n=new URL(t.baseDir,r),s=[o];return t.assetDir&&s.push(t.assetDir),n.pathname=[n.pathname,...s,e].filter(a=>!!a).join("/"),n}catch{}},we=(e,t)=>{let o=ye(e,t);return o?o.pathname:""},be=async(e,t)=>{let o=ye(e,t);if(!o)return Promise.reject(`${ct} ${e}`);let r=o.toString();return r.endsWith(".js")||(r+=".js"),import(r).catch(n=>{i.warn(ct,{url:r,error:n,metrics:ge(r)})})};var g=be(Do,{version:Ro,baseDir:_o}),Se=async()=>be("iis.min.js",{baseDir:Ao,version:"v1"}).then(e=>e&&"default"in e?e.default:e||{});var Ie=()=>{if(!D)return;let e=document.createElement("link");e.rel="preconnect",e.href=D,document.head.appendChild(e)};var Ee="interactions-aem",ve=we(`${Ee}.js`,{assetDir:"sdk"});globalThis.dataLayer=globalThis.dataLayer||[];var M=globalThis.dataLayer;var Oe="ogsEvents";globalThis[Oe]={dataPool:[],threshold:1e3,...globalThis[Oe]};var l=globalThis[Oe];var C="functional";var pt="1",No=async()=>{let e=await g;return e?(await e.onConsentReady,globalThis.OnetrustActiveGroups||b(e.SFDC_CONSENT_COOKIE)||pt):pt},ee=async e=>{let t=await g;return t?(await t.onGdprReady,t.isActiveGroup(e)):e==="required"},te=async e=>{let t=await g;if(!t)return e==="required";let o=await No(),r=t.isActiveGroup;return r(e,o)};var dt=W("uact"),ft=async e=>ee(C).then(t=>{t&&J(dt,e)}),ut=async e=>{let t=xe();return t={...t,...e},ft(t),t},xe=()=>{let e=Y(dt);return d(e)&&(e={userId:crypto.randomUUID()},ft(e)),e};p.lead=p.lead||{};var oe=p.lead;var L="_ga",re=".",Ce=3e3,Mo=()=>!d(globalThis.google_tag_manager),Te=R(Mo,Ce),Lo=()=>typeof globalThis.ga<"u"&&"getAll"in globalThis.ga,jo=R(Lo,Ce),An=new Promise(e=>jo.then(()=>e(globalThis.ga)));var gt=e=>document.cookie.includes(e),ke=async(e,t,o=Ce)=>{gt(e)||await Te.then(()=>R(()=>gt(e),o));let r=Object.entries(Ke()).filter(([n])=>n.startsWith(e));return t(r)},ht=async()=>ke(`${L}_`,e=>{let t=e.find(([o,r])=>!!o&&r.startsWith("GS"));return t?t[1]?.split(re)[2]:""}),yt=async()=>ke(L,e=>{let t=Object.fromEntries(e);return t[L]?t[L].split(re).splice(2).join(re):""}),wt=async()=>ke(`${L}c_`,e=>{if(!e||!e[0])return"";let t=e[0][1],o=t.split(re);return o[o.length-1]},0);var Hn=[`.${_}`,"opinionlab.com","sfdc.net","a.sfdcstatic.com",".sfdcdigital.com"];var Bo=()=>{let e=location.hostname;return`.${e.endsWith(_)&&Be?He(e):e}`},bt="webact";var Ho=Bo(),Ko=p.timestamp,us=3600*24*365;p.act=p.act||{};var Wo=async()=>{if("webact"in p.act)return p.act.webact;let e=b(bt);return(!(e instanceof Object)||d(e))&&(X(bt,Ho),e={}),i.debug("Storing Previous Activity",e),p.act.webact=Promise.resolve(e),e};var St=async e=>(e||(e=(await Wo()).session),(Ko-+(e||0))/1e3>1800);var It={CONVERTING_URL:"convertingPageUrl",OFFER_ID:"v28",OFFER_ID_DUPE:"c30"},Yo={EXTERNAL_DRIVER:"v0",PAID_PARAM:"v42",INTERNAL_DRIVER:"v22",CROSS_VISIT:"cvtdt",DRIVER_TYPE:"c40",CONVERTING:"v20",...It},xs=["EXTERNAL_DRIVER","CONVERTING","INTERNAL_DRIVER",...Object.keys(It)];var Cs=Object.values(Yo).reduce((e,t)=>(e[t]=e[t]||b(t),e),oe);var Et="usessid",vt=()=>{let e=sessionStorage.getItem(Et);return(St()||!e)&&(e=crypto.randomUUID(),sessionStorage.setItem(Et,e)),e},ne=()=>{let{userId:e}=xe();return e||(e=crypto.randomUUID(),ut({userId:e})),e};var j=async()=>{let e={},{clientLibs:t,sfdcBase:o}=U;if(d(o)||t.iis&&t.iis?.disabled||o.iisDisabled)return e;let r=await Se().then(a=>a.getUserInfo()).catch(()=>{});if(d(r))return e;let n={company:["CompanyName","com"],id:["user_id","id"],newRegistration:["newRegistration","nr"],orgID:["organization_id","oid"],role:["r"],relationship:["RelationshipToSalesforce","rlt"]},s=r.custom_attributes;return d(s)||(e.role=s.Role??""),Object.entries(n).reduce((a,[c,m])=>(a[c]||(a[c]=r[m.find(f=>f in r)]||""),a),e)};var Xo="optimizelyEndUserId",Re=()=>b(Xo);var _e={user:{firstName:"f",lastName:"l",jobTitle:"t",email:"e",phone:"p",company:"c",employees:"emp",country:"cn",state:"st",jobRole:"j",industry:"i",department:"ud",productInterest:"pi"},metadata:{formCampaignId:"fcid",driverCampaignId:"d"},analytics:{gaClientId:"gcid",gaPropId:"gpid",gaClickId:"gkid"}};var Js=4320*60*60,Ys=$e(_e.user);var ia=W("lsData");var Ot=le("/v1/interactions");var xt=250,Zo="x-ogs-interactions-client-id",Qo="x-ogs-deviceid",se=async()=>{let e=l.dataPool;e.length&&(l.dataPool=[],Ue(e,await F()))},Ae={method:"POST",headers:{"Content-Type":"application/json"},keepalive:!0,credentials:"include"},Ue=async(e,t)=>{if(!Ot||!await te(C))return;let o=crypto.randomUUID(),r={correlationId:o,metaData:t,records:e},n=O.default(JSON.stringify(r)),s=E("events:POST",{totalRecords:e.length,bodySize:new Blob([n]).size});i.debug("Events payload submitted",s.detail);let a=await j().then(c=>c.id||"");Ae.headers[Qo]=a||ne(),Ae.headers[Zo]=K,l.lastSent=Date.now(),Q(Ot,{body:n,...Ae,correlationId:o,metrics:s}).catch(c=>{i.warn("Error sending events",{error:c,metrics:s,correlationId:o})})},er=()=>{let e=l.threshold<xt?xt:l.threshold;(Date.now()-l.lastSent||0)>=e&&se()},Ct=async()=>{window.addEventListener("visibilitychange",se),setInterval(er,l.threshold)};var ae=(e,...t)=>{t||(t=[]);let o="_",r=Object.entries(e).reduce((n,[s,a])=>{if(["gtm.uniqueEventId"].includes(s))return n;let c=Array.isArray(a);if(a instanceof Object&&!c)return{...n,...ae(a,...t,s)};if(c){if(!a.length)return{...n,[[...t,s].join(o)]:""};let m=a.length>3?3:a.length;for(let f=0;f<m;f++)n={...n,...ae(a[f],...t,s,`${f}`)};return n}return a=typeof a>"u"?"":a,{...n,[[...t,s].join(o)]:a}},{});return t=[],r};var tr="otloc";var Tt=async()=>{let e=sessionStorage.getItem(tr);if(e)try{return JSON.parse(atob(e))}catch{}return g.then(t=>t.getOneTrust().then(o=>o.getGeolocationData()))};y.clientId||(y.clientId="unknown");var kt=60*1e3,or="webInteractions",rr="Engagement",nr="dl",sr="custEv_",Ne={deviceId:ne(),sessionId:vt(),eventType:or,category:rr,clientId:y.clientId??""},ar={optimizelyEndUserId:Re(),visitDate:new Date(p.timestamp||new Date).toISOString(),userAgent:navigator.userAgent,pageUrl:location.href.toString(),pagePathQueryParams:document.location.pathname+document.location.hash+document.location.search},ir={gaClientId:"",gaClickId:"",gaSessionId:"",country:"geoCountry",id:"tbid"},Me=pe({gaClientId:yt,gaClickId:wt,gaSessionId:ht,getOneTrustGeo:Tt,getIISUserInfo:j}).then(e=>Object.entries({...ir}).reduce((t,[o,r])=>(t[r||o]=e[o]||"",t),{})),Pe=1e3,F=async e=>d(l.data)?(l.data={...Ne,...ar,...await Me,...e||{}},Pe=new Blob([JSON.stringify(l.data)]).size,i.debug("Caching interactions meta data",{size:Pe,data:l.data}),l.data):(d(e)||(l.data={...l.data,...e}),l.data),ie=e=>{if(!("event"in e))return;let t=e.event;if(!t||!t.startsWith(sr))return;let o={...ae(e,nr),eventId:crypto.randomUUID(),dateTime:new Date().toISOString()};i.debug("Event Captured",o);let r=new Blob([JSON.stringify([o])]).size;if(r>kt)return;let n=new Blob([JSON.stringify(l.dataPool)]).size;Pe*(l.dataPool.length||1)+n+r>=kt&&se(),l.dataPool.push(o)};var cr=e=>t=>{e(t),ie(t)},Le=async e=>{if(l.gtmPush)return;let t=await g;t&&(await t.onGroupActive(t.OT_FUNCTIONAL),await Te.then(async o=>{if(!o){i.warn("GTM timeout",{metrics:E("GTM:timeout")});return}await F(e);let r=M.push;l.gtmPush=r,M.push=cr(r),M.forEach(n=>ie(n)),Ct(),i.debug("Capturing dataLayer events"),E("trap:init")}))};var Dt={...Ne,category:"Profile",eventType:"webProfiles",eventId:crypto.randomUUID(),dateTime:new Date().toISOString()},je=()=>Me.then(e=>{let{gaClickId:t,gaClientId:o,gaSessionId:r,tbid:n}=e,s={gaClickId:t,gaClientId:o,gaSessionId:r};E("profile:init"),i.debug("Sending profile data",{...Dt,...s,tbid:n}),Ue([s],{...Dt,tbid:n})});var mr=async()=>{let e="",t="",{page:o}=globalThis.digitalData||{};return await R(()=>typeof o.referrer<"u"&&typeof o.convertingpage<"u",200),t=o.referrer??t,e=o.convertingpage,{convertingPageName:e,pageReferrer:t}},Rt=async()=>{try{let{page:e,user:t}=globalThis.digitalData||{},{activityData:o}=globalThis.vp||{},{profile:r}=t[0]||{},n=r.demandbase||{},{convertingPageName:s,pageReferrer:a}=await mr();return{pageName:e.pagename||"",previousPageName:e.prevpage,convertingPageName:s,pageReferrer:a,referringHostname:a?.split("/")[2]?.split(":")[0]||"",uiFramework:e.uiframework,locale:e.locale,pageViews:o.pv,dbCompanySize:n.employee_range||"",dbIndustry:n.industry||"",visitorType:r[0].usertype,orgId:r[0].orgId}}catch(e){return i.error("Failed to map AEM data",e),{}}};var lr=25,Pt="|",Fe="sfdcUtm",z="utm",G="utm_",T="timestamp",Nt={utm_campaign:"cp",utm_objective:"ob",utm_content:"ct",utm_source:"src",utm_medium:"md",utm_adgroup:"ag",utm_term:"t",utm_matchtype:"mt",utm_country:"cn",utm_language:"l",utm_adused:"ad",d:"d",nc:"nc",[T]:"utc"},pr=Object.entries({...Nt}).reduce((e,[t,o])=>(e[o]=t,e),{});p[z]=p[z]||[];var _t=(e,t=!1,o=!1)=>{let r=t?pr:Nt,n=Object.entries(H(e)).reduce((s,[a,c])=>(r[a]&&(c=decodeURIComponent(c),c&&s.push([o?r[a]:a,c])),s),[]);return{rawString:n.map(([s,a])=>`${s}=${encodeURIComponent(a)}`).join("&"),params:Object.fromEntries(n)}},dr=async e=>{let t=await g;t&&t.onGroupActive(t.OT_FUNCTIONAL).then(()=>{if(!e.length)return;let o=e.map(r=>r.toShort()).join(Pt);localStorage.setItem(Fe,o)})},Ge=async()=>{localStorage.removeItem(Fe),p[z]=[]};var Mt=async()=>{let e=await g;e&&(await e.onConsentReady,e.onConsentUpdate(V))},fr=()=>(localStorage.getItem(Fe)||"").split(Pt).reduce((e,t)=>{try{t&&e.push(new q(t))}catch{}return e},[]),V=async()=>{if(!await te(C))return Ge(),[];let t=await p[z];if(t&&t.length)return t;let o=fr();try{let n=new q;o.length>=lr&&o.shift(),o.push(n),dr(o),i.debug("Storing UTM params",n)}catch{}let r=o.map(n=>n.toRecord());return p[z]=r,r},At,Ut,q=class extends(Ut=URL,At=T,Ut){constructor(o=location.toString()){let r=o.startsWith(G);r&&(o=o.replace(G,"https://"));super(o);k(this,At);k(this,"url");k(this,"utms");k(this,"driver");k(this,"name_capture");let{rawString:n,params:s}=_t(this.search,r,r);if(!r&&!n.includes(G))throw Error("Url must contain UTM params");this.url=this.origin+this.pathname,this.search=n,this.driver=s.d,this.name_capture=s.nc,this.utms=Object.fromEntries(Object.entries(s).filter(([a])=>a.startsWith(G))),this[T]=s[T]||new Date().toISOString(),this.searchParams.set(T,this[T])}toShort(){return[G,this.hostname,this.pathname,`?${_t(this.search,!1,!0).rawString}`].join("")}toRecord(){return{landing_page_url:this.url,driver:this.driver,name_capture:this.name_capture,[T]:this[T],...this.utms}}};(async()=>V().then(Mt))();de(ve);(async()=>(Ie(),je(),Le(await Rt()),nt(Ee,ve)))();export{V as getUtmHistory,Ge as resetUtmHistory};
//# sourceMappingURL=interactions-aem.js.map
